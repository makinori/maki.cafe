<html>
	<head>
		<style>
			* {
				margin: 0;
			}

			body {
				background-color: #111;
				font-family: "Maple Mono NL";
				font-weight: bold;
			}

			.button {
				width: 88px;
				height: 31px;
				background-color: #222;
				overflow: hidden;
				position: relative;
			}

			.pony {
				height: 37px;
				position: absolute;
				top: -4px;
				left: 51px;
				filter: brightness(1.15);
			}

			.text {
				position: absolute;
				top: 5.5px;
				left: 2.5px;
				height: 20px;
				fill: #fff;
			}

			.bg {
				position: absolute;
				top: -30px;
				left: -60px;
				/* width: 88px; */
				height: 150px;
				transform: skewX(-2deg);
				/* transform-origin: 0 calc(150px); */
				opacity: 0.6;
				filter: saturate(1) blur(2px);
			}

			.test-overlay {
				position: absolute;
				top: 32px;
				left: 32px;
				height: 31px;
				opacity: 0.4;
			}
		</style>
	</head>
	<body>
		<div class="button">
			<img class="bg" src="../../assets/the-witness.png" />
			<svg class="text" viewBox="0 0 80.464 31.401">
				<path
					d="M70.328 0c-1.947 0-3.174 1.096-3.184 2.88-.017 1.745 1.224 2.8 3.171 2.8 1.988 0 3.222-1.055 3.239-2.8C73.523 1.096 72.316 0 70.328 0m-25.31.974c-1.582 0-2.298.771-2.303 2.353l-.009 25.721c.002 1.623.74 2.354 2.322 2.354 1.623 0 2.346-.731 2.344-2.354l.003-5.274c.697.04 1.427.04 2.15 0l6.044 6.207c.99 1.015 2.076 1.42 3.658 1.42 2.232 0 2.757-.933.838-2.84l-5.71-5.923c.115-.04.23-.08.337-.162 2.814-1.298 4.826-3.692 4.853-7.221-.038-3.895-1.868-6.451-6.411-6.451q-2.86 0-5.02 1.217c-.255.163-.51.325-.725.487l-.008-7.18c.045-1.583-.74-2.354-2.362-2.354M1.711 8.277c-1.258 0-2.158.65-1.475 1.988.24.446.36.892.324 1.38L.545 29.048c-.019 1.501.943 2.354 2.282 2.354s2.195-.893 2.255-2.394l-.017-14.362c-.026-1.298.43-2.394 1.85-2.394.69 0 1.152.325 1.434.771.24.447.382 1.015.375 1.664l.011 14.564c-.033 1.42.867 2.15 2.124 2.15s2.143-.73 2.177-2.15l-.02-14.605c-.018-1.258.471-2.394 1.77-2.394 1.42 0 1.782 1.137 1.808 2.435l.01 14.32c-.02 1.502.95 2.395 2.288 2.395 1.339 0 2.244-.853 2.263-2.354l.007-15.376c-.023-3.123-1.357-5.395-4.4-5.395-2.474 0-3.758 1.46-4.114 3.124-.286-1.623-1.565-3.124-3.878-3.124-2.272 0-3.281 1.176-3.79 3.124.057-.365-.095-.771-.322-1.136-.682-1.339-1.608-1.988-2.947-1.988m30.072 0c-6.166 0-9.32 6.045-9.323 13.388-.04 7.14 3.38 9.737 7.275 9.737 1.46 0 2.694-.366 3.709-1.056 1.303-.892 2.21-2.19 2.902-4.016.171.974.384 1.947.603 2.962.372 1.42 1.305 2.11 2.806 2.11s1.955-.65 1.657-2.11c-1.705-7.14-1.509-12.698-.527-18.865.23-1.46-.339-2.15-1.84-2.15q-1.095 0-1.74.487c-.61.446-.852 1.38-.998 2.393a5.3 5.3 0 0 0-1.438-1.947c-.757-.609-1.788-.933-3.086-.933m36.77.847a5 5 0 0 0-1.048.167l-5.666 1.46c-1.396.366-1.76 1.299-1.225 2.719.575 1.42 1.59 2.11 2.83 1.785l3.022-.812c.62-.162 1.104.284 1.023.974l-.746 8.885c-.46 4.746 2.307 7.1 6.202 7.1 3.691 0 5.575-1.056 7.164-3.774.633-1.014.426-2.19-.65-3.002-1.07-.77-2.01-.81-2.79.284-.915 1.258-1.948 2.07-3.287 2.07-.69 0-1.22-.244-1.577-.893-.358-.65-.47-1.745-.32-3.651l.694-9.413c.274-2.272-1.285-4.015-3.626-3.9m-35.99 3.575c2.921 0 3.147 3.124 3.135 6.045.063 5.193-2.402 8.235-5.202 8.235-2.271 0-3.319-2.028-3.342-5.152-.042-5.071 2.163-9.128 5.409-9.128m20.258.77c1.339 0 1.94.65 1.914 2.11-.012.852-.418 1.542-1.177 2.07-1.558 1.054-3.682 1.663-5.81 1.784a1 1 0 0 1-.359.041l-.021-2.88c1.291-2.11 3.79-3.124 5.453-3.124"
				/>
			</svg>
			<img class="pony" src="ponyblink/0000.png" />
		</div>
		<!-- <img class="test-overlay" src="frame0-old.png" /> -->
		<script>
			const bgEl = document.querySelector(".bg");
			const ponyEl = document.querySelector(".pony");

			const fps = 25;
			const length = 4; // seconds
			const maxFrames = fps * length;

			const skewBase = -2;
			const skewAmount = 0.5;

			// function skewBackground(deg) {
			// 	bgEl.style.transform = "skewX(" + deg + "deg)";
			// }

			const ponyFPS = 50;

			function updateFrame(frame) {
				// update pony frame

				let ponyFrame = Math.floor((frame / fps) * ponyFPS);
				if (ponyFrame > 20) ponyFrame = 20;
				// console.log(ponyFrame);

				ponyEl.src =
					"ponyblink/" +
					ponyFrame.toString().padStart(4, "0") +
					".png";

				// skewBackground(
				// 	skewBase +
				// 		Math.sin((frame / maxFrames) * Math.PI * 2) *
				// 			skewAmount,
				// );
			}

			// for testing

			if (!new URL(document.URL).search.startsWith("?go")) {
				document.body.style = "margin: 32px; background: #333;";

				let startDate = new Date();

				function render() {
					let seconds = (new Date() - startDate) / 1000;
					let frame = Math.floor(seconds * fps) % maxFrames;
					updateFrame(frame);
					requestAnimationFrame(render);
				}

				requestAnimationFrame(render);
			}
		</script>
	</body>
</html>
